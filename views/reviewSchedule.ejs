<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Review Schedule</title>

  <!-- New dedicated stylesheet for this page -->
  <link rel="stylesheet" href="/styles/formStyles.css" />

  <!-- Using formStyles.css as well -->
  <link rel="stylesheet" href="/styles/reviewSchedule.css" />

  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
  />
  <link
    rel="stylesheet"
    href="//cdn.datatables.net/2.3.4/css/dataTables.dataTables.min.css"
  />

  <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
  <script src="//cdn.datatables.net/2.3.4/js/dataTables.min.js"></script>

</head>
<body>
  <header>
    <div>
      <img src="/img/GRC_Logo_White.png" alt="Green River Logo" />
      <h1>Review Schedule</h1>
    </div>
  </header>

  <main id="review-layout">

    <!-- LEFT SIDEBAR: Year Selector -->
    <aside id="year-sidebar">
      <h2>Select Year</h2>

      <ul>
        <% availableYears.forEach(yr => { %>
          <li>
            <a 
              href="/review-schedule-view?year=<%= yr %>"
              class="<%= yr === selectedYear ? 'active-year' : '' %>"
            >
              <%= yr %>
            </a>
          </li>
        <% }) %>
      </ul>
    </aside>

    <!-- RIGHT COLUMN: Programs List -->
    <section id="program-list">
      <% if (!selectedYear) { %>

        <p>Please select a year from the left.</p>

      <% } else if (programs.length === 0) { %>

        <h2>No programs scheduled for <%= selectedYear %>.</h2>

      <% } else { %>

        <h2>Programs Under Review for <%= selectedYear %></h2>

        <!-- <ul>
          <% programs.forEach(p => { %>
            <li>
              <a 
                href="/form-from-under-review?programID=<%= p.ProgramID %>"
                class="program-link"
              >
                <strong><%= p.AcademicPrograms %></strong>
                <span class="program-division"> â€” <%= p.DivisionName %></span>
              </a>
            </li>
          <% }) %>
        </ul> -->
        <table id="order-table">
          <thead>
            <tr>
              <th>Divisions</th>
              <th>Programs</th>
              <th>UnderReview</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            
            <% orders.forEach(order => { %>
              <tr>
                <td><strong><%= order.DivisionName %></strong></td>
                <td><%= order.AcademicPrograms %></td>
                <td>
                  <!-- checks if at least one element in the array matches a condition -->
                  <%= programs.some(p => p.AcademicPrograms === order.AcademicPrograms) ? "Yes" : "No" %>
                </td>
                <td>
                  <a href="/form-from-under-review?programID=<%= 
                    (programs.find(p => p.AcademicPrograms === order.AcademicPrograms) || {}).ProgramID %>">
                    Edit/View
                  </a>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>

      <% } %>
    </section>

  </main>

  <script>
    $(document).ready(function() {
      $('#order-table').DataTable();
    });
  </script>


  <div class="review-back-wrapper">
    <a href="/" class="btn">
      <i class="fa-solid fa-arrow-left"></i> Back to Summary
    </a>
  </div>
  
</body>
</html>



